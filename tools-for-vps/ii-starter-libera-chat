#!/bin/sh

export HOME=/home/raskin
export PATH="$PATH:$HOME/tools/bin/"

while true; do
        while ps -ef | grep -v grep |
                        grep ' ii -s irc.libera.chat ' >/dev/null; do
                sleep 1;
        done;
        rm ~/mnt/irc/irc.libera.chat/in
        ii -s irc.libera.chat -i ~/mnt/irc/ -n IdleBot_$(
                        dd if=/dev/urandom bs=1 count=4 | xxd -ps ) &
        while ! test -e  ~/mnt/irc/irc.libera.chat/in; do
                sleep 1;
        done
        for c in nixos-security stumpwm irp tunes bussard ca-duel cl-fuse query-fs nixos-de spectrum; do
                echo /j "#$c" > ~/mnt/irc/irc.libera.chat/in;
                sleep 1;
        done;
done
